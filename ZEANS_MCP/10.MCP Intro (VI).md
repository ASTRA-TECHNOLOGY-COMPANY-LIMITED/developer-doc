# Tá»•ng quan vá» Giao thá»©c Ngá»¯ cáº£nh MÃ´ hÃ¬nh (MCP) vÃ  Chi tiáº¿t Giao thá»©c

TÃ i liá»‡u nÃ y giáº£i thÃ­ch cÃ¡c khÃ¡i niá»‡m cÆ¡ báº£n, cÃ¡c thÃ nh pháº§n (mÃ¡y chá»§, mÃ¡y khÃ¡ch, mÃ¡y phá»¥c vá»¥), lÆ°á»£c Ä‘á»“ tin nháº¯n vÃ  luá»“ng giao thá»©c cá»§a Giao thá»©c Ngá»¯ cáº£nh MÃ´ hÃ¬nh (MCP). NÃ³ cÅ©ng Ä‘á» cáº­p ngáº¯n gá»n vá» SDK vÃ  cÃ¡c vÃ­ dá»¥ mÃ£ nguá»“n má»Ÿ Ä‘á»ƒ giÃºp báº¡n dá»… dÃ ng báº¯t Ä‘áº§u.

---

## Má»¥c lá»¥c

1. [Tá»•ng quan vá» MCP](#tá»•ng-quan-vá»-mcp)
2. [Äá»‹nh nghÄ©a Vai trÃ²: MÃ¡y chá»§, MÃ¡y khÃ¡ch, MÃ¡y phá»¥c vá»¥](#Ä‘á»‹nh-nghÄ©a-vai-trÃ²-mÃ¡y-chá»§-mÃ¡y-khÃ¡ch-mÃ¡y-phá»¥c-vá»¥)
3. [LÆ°á»£c Ä‘á»“ Tin nháº¯n MCP](#lÆ°á»£c-Ä‘á»“-tin-nháº¯n-mcp)
    - [Cáº¥u trÃºc Dá»±a trÃªn JSON-RPC](#cáº¥u-trÃºc-dá»±a-trÃªn-json-rpc)
    - [CÃ¡c Loáº¡i Tin nháº¯n ChÃ­nh vÃ  VÃ­ dá»¥](#cÃ¡c-loáº¡i-tin-nháº¯n-chÃ­nh-vÃ -vÃ­-dá»¥)
        - [Khá»Ÿi táº¡o vÃ  Quáº£n lÃ½ PhiÃªn](#khá»Ÿi-táº¡o-vÃ -quáº£n-lÃ½-phiÃªn)
        - [Tin nháº¯n LiÃªn quan Ä‘áº¿n Prompt](#tin-nháº¯n-liÃªn-quan-Ä‘áº¿n-prompt)
        - [Tin nháº¯n LiÃªn quan Ä‘áº¿n TÃ i nguyÃªn](#tin-nháº¯n-liÃªn-quan-Ä‘áº¿n-tÃ i-nguyÃªn)
        - [Tin nháº¯n LiÃªn quan Ä‘áº¿n CÃ´ng cá»¥](#tin-nháº¯n-liÃªn-quan-Ä‘áº¿n-cÃ´ng-cá»¥)
        - [Táº¡o Pháº£n há»“i LLM (Láº¥y máº«u)](#táº¡o-pháº£n-há»“i-llm-láº¥y-máº«u)
        - [Tin nháº¯n LiÃªn quan Ä‘áº¿n Root](#tin-nháº¯n-liÃªn-quan-Ä‘áº¿n-root)
4. [Luá»“ng Giao thá»©c (SÆ¡ Ä‘á»“)](#luá»“ng-giao-thá»©c-sÆ¡-Ä‘á»“)
5. [SDK vÃ  CÃ´ng cá»¥ MÃ£ nguá»“n Má»Ÿ](#sdk-vÃ -cÃ´ng-cá»¥-mÃ£-nguá»“n-má»Ÿ)

---

## Tá»•ng quan vá» MCP

Giao thá»©c Ngá»¯ cáº£nh MÃ´ hÃ¬nh (MCP) lÃ  má»™t **giao thá»©c truyá»n thÃ´ng chuáº©n hÃ³a** Ä‘á»ƒ káº¿t ná»‘i MÃ´ hÃ¬nh NgÃ´n ngá»¯ Lá»›n (LLM) vá»›i cÃ¡c nguá»“n dá»¯ liá»‡u hoáº·c cÃ´ng cá»¥ bÃªn ngoÃ i (há»‡ thá»‘ng tá»‡p, cÆ¡ sá»Ÿ dá»¯ liá»‡u, API, v.v.).  
Má»¥c Ä‘Ã­ch chÃ­nh lÃ  cho phÃ©p cÃ¡c á»©ng dá»¥ng LLM nháº­n Ä‘Æ°á»£c ngá»¯ cáº£nh bá»• sung cáº§n thiáº¿t (dá»¯ liá»‡u, prompt, káº¿t quáº£ cÃ´ng cá»¥, v.v.) theo cÃ¡ch chuáº©n hÃ³a.

---

## Äá»‹nh nghÄ©a Vai trÃ²: MÃ¡y chá»§, MÃ¡y khÃ¡ch, MÃ¡y phá»¥c vá»¥

-   **MÃ¡y chá»§ (Host)**

    -   **Äá»‹nh nghÄ©a:** Báº£n thÃ¢n á»©ng dá»¥ng hoáº·c cÃ´ng cá»¥ LLM (vÃ­ dá»¥: chatbot AI, tiá»‡n Ã­ch má»Ÿ rá»™ng IDE, v.v.).
    -   **Vai trÃ²:** Äiá»u phá»‘i toÃ n bá»™ yÃªu cáº§u vÃ  thu tháº­p ngá»¯ cáº£nh bÃªn ngoÃ i Ä‘á»ƒ chuyá»ƒn Ä‘áº¿n mÃ´ hÃ¬nh.

-   **MÃ¡y khÃ¡ch (Client)**

    -   **Äá»‹nh nghÄ©a:** MÃ´-Ä‘un truyá»n thÃ´ng MCP chuyÃªn dá»¥ng trong mÃ¡y chá»§, xá»­ lÃ½ trao Ä‘á»•i tin nháº¯n JSON-RPC vá»›i mÃ¡y phá»¥c vá»¥ MCP.
    -   **Vai trÃ²:** Quáº£n lÃ½ káº¿t ná»‘i giá»¯a mÃ¡y chá»§ vÃ  mÃ¡y phá»¥c vá»¥ MCP, vÃ  truyá»n tin nháº¯n yÃªu cáº§u/pháº£n há»“i.

-   **MÃ¡y phá»¥c vá»¥ (Server)**

    -   **Äá»‹nh nghÄ©a:** Má»™t dá»‹ch vá»¥ bá»™c lá»™ dá»¯ liá»‡u hoáº·c cÃ´ng cá»¥ bÃªn ngoÃ i (vÃ­ dá»¥: há»‡ thá»‘ng tá»‡p, API, mÃ´ hÃ¬nh Vision, v.v.) thÃ´ng qua giao diá»‡n MCP.
    -   **Vai trÃ²:** Hoáº¡t Ä‘á»™ng nhÆ° má»™t "nhÃ  cung cáº¥p thÃ´ng tin" táº¡o hoáº·c xá»­ lÃ½ dá»¯ liá»‡u Ä‘á»ƒ cung cáº¥p ngá»¯ cáº£nh cho LLM.

-   **TÃ³m táº¯t Vai trÃ² ThÃ nh pháº§n MCP**

| ThÃ nh pháº§n          | MÃ´ táº£ Vai trÃ²                                                                                           |
| ------------------- | ------------------------------------------------------------------------------------------------------- |
| **MÃ¡y chá»§ MCP**     | ðŸ§  **Chá»n/Káº¿t há»£p** mÃ¡y phá»¥c vá»¥ vÃ  prompt MCP phÃ¹ há»£p dá»±a trÃªn yÃªu cáº§u ngÃ´n ngá»¯ tá»± nhiÃªn cá»§a ngÆ°á»i dÃ¹ng |
| **MÃ¡y khÃ¡ch MCP**   | ðŸ”Œ **Xá»­ lÃ½ Truyá»n thÃ´ng** gá»­i tin nháº¯n Ä‘áº¿n vÃ  nháº­n pháº£n há»“i tá»« mÃ¡y phá»¥c vá»¥ dá»±a trÃªn giao thá»©c MCP       |
| **MÃ¡y phá»¥c vá»¥ MCP** | ðŸ“¦ **NhÃ  cung cáº¥p Dá»¯ liá»‡u/Chá»©c nÄƒng** Ä‘á»‹nh nghÄ©a vÃ  cung cáº¥p prompt, cÃ´ng cá»¥, tÃ i nguyÃªn, v.v.          |

> **VÃ­ dá»¥ (á»¨ng dá»¥ng PhÃ¢n tÃ­ch áº¢nh dá»±a trÃªn á»¨ng dá»¥ng Di Ä‘á»™ng)**
>
> -   **á»¨ng dá»¥ng Di Ä‘á»™ng (Frontend):** Vai trÃ² giao diá»‡n ngÆ°á»i dÃ¹ng Ä‘Æ¡n giáº£n, khÃ´ng Ä‘Æ°á»£c bao gá»“m trá»±c tiáº¿p trong cáº¥u trÃºc MCP
> -   **MÃ¡y chá»§ Backend:** Hoáº¡t Ä‘á»™ng nhÆ° **MÃ¡y chá»§** MCP vÃ  giao tiáº¿p ná»™i bá»™ vá»›i bÃªn ngoÃ i (vÃ­ dá»¥: mÃ¡y phá»¥c vá»¥ lÆ°u trá»¯ áº£nh MCP) thÃ´ng qua **MÃ¡y khÃ¡ch** MCP
> -   **MÃ¡y chá»§ LÆ°u trá»¯/PhÃ¢n tÃ­ch áº¢nh:** **MÃ¡y phá»¥c vá»¥** MCP cung cáº¥p siÃªu dá»¯ liá»‡u áº£nh hoáº·c káº¿t quáº£ mÃ´ hÃ¬nh Vision

---

## LÆ°á»£c Ä‘á»“ Tin nháº¯n MCP

MCP trao Ä‘á»•i tin nháº¯n dá»±a trÃªn tiÃªu chuáº©n JSON-RPC 2.0. Táº¥t cáº£ tin nháº¯n tuÃ¢n theo cáº¥u trÃºc cÆ¡ báº£n sau.

### Cáº¥u trÃºc Dá»±a trÃªn JSON-RPC

-   **TrÆ°á»ng Chung:**
    -   `"jsonrpc": "2.0"`
    -   YÃªu cáº§u bao gá»“m cÃ¡c trÆ°á»ng `"id"`, `"method"` vÃ  `"params"`
    -   Pháº£n há»“i bao gá»“m `"id"` cá»§a yÃªu cáº§u cÃ¹ng vá»›i trÆ°á»ng `"result"` hoáº·c `"error"`
    -   ThÃ´ng bÃ¡o Ä‘Æ°á»£c gá»­i khÃ´ng cÃ³ `"id"` vÃ  khÃ´ng cÃ³ pháº£n há»“i

### CÃ¡c Loáº¡i Tin nháº¯n ChÃ­nh vÃ  VÃ­ dá»¥

#### Khá»Ÿi táº¡o vÃ  Quáº£n lÃ½ PhiÃªn

-   **YÃªu cáº§u Khá»Ÿi táº¡o:**  
    YÃªu cáº§u káº¿t ná»‘i ban Ä‘áº§u vá»›i mÃ¡y phá»¥c vá»¥ bao gá»“m phiÃªn báº£n giao thá»©c, kháº£ nÄƒng vÃ  thÃ´ng tin mÃ¡y khÃ¡ch.

    ```json
    {
        "jsonrpc": "2.0",
        "id": "init1",
        "method": "initialize",
        "params": {
            "protocolVersion": "2024-11-05",
            "capabilities": { "roots": { "listChanged": true }, "sampling": {} },
            "clientInfo": { "name": "SomeClient", "version": "1.2.3" }
        }
    }
    ```

-   **Pháº£n há»“i Khá»Ÿi táº¡o:**
    ```json
    {
        "jsonrpc": "2.0",
        "id": "init1",
        "result": {
            "protocolVersion": "2024-11-05",
            "capabilities": { "prompts": { "listChanged": true }, "tools": {} },
            "serverInfo": { "name": "MyServer", "version": "0.8.15" }
        }
    }
    ```

#### Tin nháº¯n LiÃªn quan Ä‘áº¿n Prompt

-   **Liá»‡t kÃª Prompt:**
    ```json
    {
        "jsonrpc": "2.0",
        "id": 1,
        "method": "prompts/list",
        "params": { "cursor": "optional-cursor-value" }
    }
    ```
-   **Pháº£n há»“i Liá»‡t kÃª Prompt:**

    ```json
    {
        "jsonrpc": "2.0",
        "id": 1,
        "result": {
            "prompts": [
                {
                    "name": "code_review",
                    "description": "PhÃ¢n tÃ­ch cháº¥t lÆ°á»£ng mÃ£ vÃ  Ä‘á» xuáº¥t cáº£i tiáº¿n",
                    "arguments": [
                        {
                            "name": "code",
                            "description": "MÃ£ nguá»“n cáº§n xem xÃ©t",
                            "required": true
                        }
                    ]
                },
                {
                    "name": "summarize_text",
                    "description": "TÃ³m táº¯t má»™t tÃ i liá»‡u vÄƒn báº£n Ä‘Ã£ cho",
                    "arguments": [
                        {
                            "name": "text",
                            "description": "VÄƒn báº£n cáº§n tÃ³m táº¯t",
                            "required": true
                        }
                    ]
                }
            ],
            "nextCursor": null
        }
    }
    ```

-   **Láº¥y Prompt:**
    ```json
    {
        "jsonrpc": "2.0",
        "id": 2,
        "method": "prompts/get",
        "params": {
            "name": "code_review",
            "arguments": { "code": "def hello():\n    print('world')" }
        }
    }
    ```
-   **Pháº£n há»“i Láº¥y Prompt:**
    ```json
    {
        "jsonrpc": "2.0",
        "id": 2,
        "result": {
            "description": "Prompt xem xÃ©t mÃ£",
            "messages": [
                {
                    "role": "user",
                    "content": {
                        "type": "text",
                        "text": "Vui lÃ²ng xem xÃ©t mÃ£ sau vÃ  Ä‘á» xuáº¥t cáº£i tiáº¿n:\n\n{{code}}"
                    }
                }
            ]
        }
    }
    ```

#### Tin nháº¯n LiÃªn quan Ä‘áº¿n TÃ i nguyÃªn

-   **Liá»‡t kÃª TÃ i nguyÃªn:**

    ```json
    {
        "jsonrpc": "2.0",
        "id": 10,
        "method": "resources/list",
        "params": { "cursor": "optional-cursor-value" }
    }
    ```

-   **Äá»c TÃ i nguyÃªn:**

    ```json
    {
        "jsonrpc": "2.0",
        "id": 11,
        "method": "resources/read",
        "params": { "uri": "file:///project/src/main.rs" }
    }
    ```

#### Tin nháº¯n LiÃªn quan Ä‘áº¿n CÃ´ng cá»¥

-   **Liá»‡t kÃª CÃ´ng cá»¥:**

    ```json
    {
        "jsonrpc": "2.0",
        "id": 20,
        "method": "tools/list",
        "params": { "cursor": "optional-cursor-value" }
    }
    ```

-   **Gá»i CÃ´ng cá»¥:**

    ```json
    {
        "jsonrpc": "2.0",
        "id": 21,
        "method": "tools/call",
        "params": {
            "name": "get_weather",
            "arguments": { "location": "New York" }
        }
    }
    ```

#### Táº¡o Pháº£n há»“i LLM (Láº¥y máº«u; sampling/createMessage)

-   **YÃªu cáº§u Táº¡o Tin nháº¯n LLM:**

    ```json
    {
        "jsonrpc": "2.0",
        "id": 5,
        "method": "sampling/createMessage",
        "params": {
            "messages": [
                {
                    "role": "user",
                    "content": { "type": "text", "text": "Thá»§ Ä‘Ã´ cá»§a PhÃ¡p lÃ  gÃ¬?" }
                }
            ],
            "modelPreferences": {
                "hints": [{ "name": "claude-3-sonnet" }],
                "intelligencePriority": 0.8,
                "speedPriority": 0.5
            },
            "systemPrompt": "Báº¡n lÃ  má»™t trá»£ lÃ½ há»¯u Ã­ch.",
            "maxTokens": 100
        }
    }
    ```

-   **VÃ­ dá»¥ Pháº£n há»“i LLM:**

    ```json
    {
        "jsonrpc": "2.0",
        "id": 5,
        "result": {
            "role": "assistant",
            "content": { "type": "text", "text": "Thá»§ Ä‘Ã´ cá»§a PhÃ¡p lÃ  Paris." },
            "model": "claude-3-sonnet-20240307",
            "stopReason": "endTurn"
        }
    }
    ```

#### Tin nháº¯n LiÃªn quan Ä‘áº¿n Root

-   **Liá»‡t kÃª Root:**

    ```json
    {
        "jsonrpc": "2.0",
        "id": 30,
        "method": "roots/list"
    }
    ```

-   **VÃ­ dá»¥ Pháº£n há»“i Root:**

    ```json
    {
        "jsonrpc": "2.0",
        "id": 30,
        "result": {
            "roots": [{ "uri": "file:///home/user/projects/myproject", "name": "Dá»± Ã¡n cá»§a TÃ´i" }]
        }
    }
    ```

## Luá»“ng Giao thá»©c (SÆ¡ Ä‘á»“)

```mermaid
flowchart TD
    A[MÃ¡y khÃ¡ch: Gá»­i yÃªu cáº§u khá»Ÿi táº¡o]
    B[MÃ¡y phá»¥c vá»¥: Gá»­i pháº£n há»“i khá»Ÿi táº¡o]
    C[MÃ¡y khÃ¡ch: Gá»­i hoÃ n thÃ nh khá»Ÿi táº¡o]
    D[MÃ¡y khÃ¡ch: YÃªu cáº§u danh sÃ¡ch prompt/tÃ i nguyÃªn/cÃ´ng cá»¥]
    E[MÃ¡y phá»¥c vá»¥: Gá»­i pháº£n há»“i danh sÃ¡ch]
    F[MÃ¡y khÃ¡ch: Gá»i prompt/tÃ i nguyÃªn/cÃ´ng cá»¥ Ä‘Æ°á»£c yÃªu cáº§u]
    G[MÃ¡y khÃ¡ch: Gá»­i yÃªu cáº§u sampling/createMessage]
    H[MÃ¡y chá»§: Soáº¡n tin nháº¯n vá»›i ngá»¯ cáº£nh bÃªn ngoÃ i]
    I[LLM: Táº¡o pháº£n há»“i dá»±a trÃªn tin nháº¯n vÃ  ngá»¯ cáº£nh]
    J[MÃ¡y khÃ¡ch: Nháº­n vÃ  chuyá»ƒn pháº£n há»“i LLM]

    A --> B
    B --> C
    C --> D
    D --> E
    E --> F
    F --> G
    G --> H
    H --> I
    I --> J
```

## SDK vÃ  CÃ´ng cá»¥ MÃ£ nguá»“n Má»Ÿ

-   **SDK:**

    -   [SDK MCP cho Python](https://github.com/your-project/mcp-sdk-python)
    -   [SDK MCP cho JavaScript](https://github.com/your-project/mcp-sdk-js)
    -   [SDK MCP cho Java](https://github.com/your-project/mcp-sdk-java)

-   **CÃ´ng cá»¥ MÃ£ nguá»“n Má»Ÿ:**
    -   [Dá»± Ã¡n VÃ­ dá»¥ MCP](https://github.com/your-project/mcp-example-project)
    -   [HÆ°á»›ng dáº«n TÃ­ch há»£p MCP](https://github.com/your-project/mcp-integration-guide)
